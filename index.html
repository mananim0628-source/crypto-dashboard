<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ í¬ë¦½í†  6ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ PRO</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 100%); 
            color: white; 
            min-height: 100vh; 
        }
        
        .header { 
            background: rgba(0, 0, 0, 0.7); 
            backdrop-filter: blur(10px); 
            padding: 20px; 
            text-align: center; 
            border-bottom: 1px solid rgba(0, 255, 136, 0.3);
        }
        
        .header h1 { 
            font-size: 28px; 
            background: linear-gradient(45deg, #00ff88, #48cae4); 
            background-clip: text; 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }
        
        .update-status { 
            font-size: 12px; 
            color: #48cae4; 
            margin-top: 10px;
        }
        
        .api-status { 
            display: inline-block; 
            padding: 3px 8px; 
            background: rgba(0, 255, 136, 0.2); 
            color: #00ff88; 
            border-radius: 5px; 
            margin-left: 10px;
        }
        
        .api-error {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
        }

        /* ê²€ìƒ‰ ê¸°ëŠ¥ ìŠ¤íƒ€ì¼ */
        .search-container {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        #coinSearch {
            flex: 1;
            padding: 15px;
            border: 2px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 16px;
        }

        #coinSearch::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        #searchBtn {
            padding: 15px 25px;
            background: linear-gradient(45deg, #00ff88, #48cae4);
            border: none;
            border-radius: 10px;
            color: #0a0a0f;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        #searchBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 136, 0.3);
        }

        .suggestions-list {
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(0, 255, 136, 0.2);
        }

        .suggestion-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: background 0.2s;
        }

        .suggestion-item:hover {
            background: rgba(0, 255, 136, 0.1);
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .search-results {
            margin: 30px auto;
            max-width: 1600px;
            padding: 0 20px;
        }

        .search-results h2 {
            color: #48cae4;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .container { 
            max-width: 1600px; 
            margin: 0 auto; 
            padding: 20px; 
        }
        
        .price-cards { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        
        .price-card { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px); 
            border: 2px solid; 
            border-radius: 15px; 
            padding: 25px; 
            transition: all 0.3s;
        }
        
        .price-card.bullish { 
            border-color: #00ff88; 
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.2); 
        }
        
        .price-card.bearish { 
            border-color: #ff4757; 
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.2); 
        }
        
        .price-card.neutral { 
            border-color: #feca57; 
            box-shadow: 0 0 20px rgba(254, 202, 87, 0.2); 
        }
        
        .coin-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 15px; 
        }
        
        .coin-name { 
            font-size: 20px; 
            font-weight: bold; 
        }
        
        .coin-score {
            font-size: 16px;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 8px;
            background: rgba(72, 202, 228, 0.2);
            color: #48cae4;
        }
        
        .coin-price { 
            font-size: 32px; 
            font-weight: bold; 
            color: #00ff88; 
            margin: 15px 0; 
        }
        
        .price-change { 
            padding: 8px 12px; 
            border-radius: 8px; 
            font-size: 14px; 
            font-weight: bold; 
            display: inline-block; 
            margin-bottom: 15px;
        }
        
        .bullish .price-change { 
            background: rgba(0, 255, 136, 0.2); 
            color: #00ff88; 
        }
        
        .bearish .price-change { 
            background: rgba(255, 71, 87, 0.2); 
            color: #ff4757; 
        }
        
        .neutral .price-change { 
            background: rgba(254, 202, 87, 0.2); 
            color: #feca57; 
        }
        
        .trading-info {
            background: rgba(72, 202, 228, 0.1);
            border: 1px solid rgba(72, 202, 228, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .strategy-direction {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .long-strategy {
            color: #00ff88;
        }
        
        .short-strategy {
            color: #ff4757;
        }
        
        .hold-strategy {
            color: #feca57;
        }
        
        .trading-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .trading-item {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            font-size: 14px;
        }
        
        .trading-label {
            color: #a0a0a0;
        }
        
        .trading-value {
            font-weight: bold;
        }
        
        .entry-price { color: #48cae4; }
        .target-price { color: #00ff88; }
        .stop-loss { color: #ff4757; }
        .risk-reward { color: #feca57; }
        
        .checklist-container { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(0, 255, 136, 0.3); 
            border-radius: 20px; 
            padding: 30px; 
            margin-bottom: 30px; 
        }
        
        .checklist-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 30px; 
            flex-wrap: wrap;
        }
        
        .checklist-title { 
            font-size: 24px; 
            color: #00ff88; 
        }
        
        .total-score { 
            font-size: 36px; 
            font-weight: bold; 
            padding: 15px 30px; 
            border-radius: 15px; 
            background: linear-gradient(135deg, #00ff88, #48cae4); 
            color: #0a0a0f; 
        }
        
        .checklist-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 15px; 
        }
        
        .checklist-item { 
            background: rgba(255, 255, 255, 0.03); 
            border: 1px solid rgba(255, 255, 255, 0.1); 
            border-radius: 10px; 
            padding: 20px; 
        }
        
        .checklist-item-header { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 10px; 
        }
        
        .checklist-score { 
            font-weight: bold; 
            color: #48cae4; 
        }
        
        .progress-bar { 
            height: 8px; 
            background: rgba(255, 255, 255, 0.1); 
            border-radius: 4px; 
            overflow: hidden; 
        }
        
        .progress-fill { 
            height: 100%; 
            background: linear-gradient(90deg, #48cae4, #00ff88); 
            transition: width 0.5s; 
        }
        
        .strategy-container { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(10px); 
            border: 1px solid rgba(0, 255, 136, 0.3); 
            border-radius: 20px; 
            padding: 30px; 
        }
        
        .strategy-signal { 
            font-size: 32px; 
            font-weight: bold; 
            margin-bottom: 20px; 
        }
        
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .strategy-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        
        .strategy-card-title {
            font-size: 14px;
            color: #a0a0a0;
            margin-bottom: 10px;
        }
        
        .strategy-card-value {
            font-size: 24px;
            font-weight: bold;
            color: #00ff88;
        }
        
        .debug-info {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            margin: 20px;
            border-radius: 10px;
            font-size: 12px;
            color: #666;
            display: block;
        }
        
        @media (max-width: 768px) {
            .price-cards { 
                grid-template-columns: 1fr; 
            }
            
            .checklist-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .trading-grid {
                grid-template-columns: 1fr;
            }

            .search-box {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ í¬ë¦½í†  6ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ PRO</h1>
        <div class="update-status">
            ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: <span id="lastUpdate">-</span> | ë‹¤ìŒ ì—…ë°ì´íŠ¸: <span id="countdown">60</span>ì´ˆ
            <span class="api-status" id="apiStatus">API ì—°ê²°ì¤‘...</span>
        </div>
    </div>

    <!-- ê²€ìƒ‰ ì„¹ì…˜ -->
    <div class="search-container">
        <div class="search-box">
            <input type="text" id="coinSearch" placeholder="ì½”ì¸ëª… ì…ë ¥ (ì˜ˆ: doge, shib, matic, uni, link)">
            <button id="searchBtn">ğŸ” ë¶„ì„</button>
        </div>
        <div id="searchSuggestions" class="suggestions-list"></div>
    </div>

    <!-- ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ ì„¹ì…˜ -->
    <div id="searchResults" class="search-results" style="display: none;">
        <h2>ğŸ” ê²€ìƒ‰ ë¶„ì„ ê²°ê³¼</h2>
        <div id="searchedCoinCard" class="price-cards"></div>
    </div>

    <div class="container">
        <!-- ë””ë²„ê·¸ ì •ë³´ -->
        <div id="debugInfo" class="debug-info">
            <strong>ë””ë²„ê·¸ ì •ë³´:</strong><br>
            API ìƒíƒœ: <span id="debugApiStatus">í™•ì¸ì¤‘...</span><br>
            ë§ˆì§€ë§‰ ìš”ì²­: <span id="debugLastRequest">-</span><br>
            ì‘ë‹µ ë°ì´í„°: <span id="debugResponse">-</span>
        </div>
        
        <div id="priceCards" class="price-cards"></div>

        <div class="checklist-container">
            <div class="checklist-header">
                <h2 class="checklist-title">ğŸ“Š 7ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¶„ì„</h2>
                <div class="total-score" id="totalScore">0/140ì </div>
            </div>
            <div id="checklistGrid" class="checklist-grid"></div>
        </div>

        <div class="strategy-container">
            <div class="strategy-signal" id="strategySignal">ğŸ¯ AI ê¸°ë°˜ ì „ëµ ì¶”ì²œ</div>
            
            <div class="strategy-grid">
                <div class="strategy-card">
                    <div class="strategy-card-title">ì¶”ì²œ ë ˆë²„ë¦¬ì§€</div>
                    <div class="strategy-card-value" id="leverageRec">ê³„ì‚°ì¤‘...</div>
                </div>
                <div class="strategy-card">
                    <div class="strategy-card-title">í¬ì§€ì…˜ ë¹„ì¤‘</div>
                    <div class="strategy-card-value" id="positionSize">ê³„ì‚°ì¤‘...</div>
                </div>
                <div class="strategy-card">
                    <div class="strategy-card-title">í‰ê·  ì†ìµë¹„</div>
                    <div class="strategy-card-value" id="avgRiskReward">ê³„ì‚°ì¤‘...</div>
                </div>
                <div class="strategy-card">
                    <div class="strategy-card-title">ì‹œì¥ ìƒíƒœ</div>
                    <div class="strategy-card-value" id="marketStatus">ë¶„ì„ì¤‘...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API í‚¤ ì„¤ì • (CoinGecko PRO)
        const API_KEY = 'CG-AJku92n1VmZV1ZQ2mp46DA2C';
        let countdown = 60;
        let cryptoData = [];
        let isApiWorking = false;
        
        // ì²´í¬ë¦¬ìŠ¤íŠ¸ ì •ì˜
        const checklistItems = [
            { id: 'macro', name: 'ğŸŒ ê±°ì‹œí™˜ê²½', max: 20, score: 0 },
            { id: 'etf', name: 'ğŸ“Š ETFÂ·ì œë„ê¶Œ ìê¸ˆ', max: 25, score: 0 },
            { id: 'onchain', name: 'ğŸ”— ì˜¨ì²´ì¸ í•µì‹¬', max: 25, score: 0 },
            { id: 'ai', name: 'ğŸ¤– AIÂ·ë©”íƒ€ë²„ìŠ¤', max: 20, score: 0 },
            { id: 'futures', name: 'ğŸ“ˆ ì„ ë¬¼ì‹œì¥', max: 20, score: 0 },
            { id: 'technical', name: 'ğŸ“‰ ê¸°ìˆ ì  ë¶„ì„', max: 20, score: 0 },
            { id: 'strategy', name: 'ğŸ¯ ì „ëµ', max: 10, score: 0 }
        ];

        // ë””ë²„ê·¸ ì •ë³´ ì—…ë°ì´íŠ¸
        function updateDebugInfo(status, request, response) {
            document.getElementById('debugApiStatus').textContent = status;
            document.getElementById('debugLastRequest').textContent = request;
            document.getElementById('debugResponse').textContent = response;
        }

        // ì½”ì¸ ê²€ìƒ‰ API
        async function searchCoin(query) {
            try {
                const url = `https://api.coingecko.com/api/v3/search?query=${query}`;
                const response = await fetch(url, {
                    headers: {
                        'Accept': 'application/json',
                        'x-cg-pro-api-key': API_KEY
                    }
                });
                
                if (!response.ok) throw new Error('ê²€ìƒ‰ ì‹¤íŒ¨');
                
                const data = await response.json();
                return data.coins.slice(0, 5); // ìƒìœ„ 5ê°œë§Œ
            } catch (error) {
                console.error('ê²€ìƒ‰ ì—ëŸ¬:', error);
                return [];
            }
        }

        // íŠ¹ì • ì½”ì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function fetchSpecificCoin(coinId) {
            try {
                const url = `https://api.coingecko.com/api/v3/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true`;
                
                const response = await fetch(url, {
                    headers: {
                        'Accept': 'application/json',
                        'x-cg-pro-api-key': API_KEY
                    }
                });
                
                if (!response.ok) throw new Error('ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨');
                
                const data = await response.json();
                const coinData = data[coinId];
                
                if (!coinData) throw new Error('ì½”ì¸ ë°ì´í„° ì—†ìŒ');
                
                return {
                    id: coinId,
                    symbol: coinId.toUpperCase(),
                    name: coinId,
                    icon: 'ğŸ”',
                    price: coinData.usd,
                    change: coinData.usd_24h_change || 0,
                    volume: coinData.usd_24h_vol || 0,
                    marketCap: coinData.usd_market_cap || 0
                };
            } catch (error) {
                console.error('ì½”ì¸ ë°ì´í„° ì—ëŸ¬:', error);
                return null;
            }
        }

        // ìë™ì™„ì„± ê¸°ëŠ¥
        let searchTimeout;
        document.getElementById('coinSearch').addEventListener('input', function(e) {
            const query = e.target.value.trim();
            
            clearTimeout(searchTimeout);
            
            if (query.length < 2) {
                document.getElementById('searchSuggestions').innerHTML = '';
                return;
            }
            
            searchTimeout = setTimeout(async () => {
                const suggestions = await searchCoin(query);
                displaySuggestions(suggestions);
            }, 300);
        });

        // ê²€ìƒ‰ ì œì•ˆ í‘œì‹œ
        function displaySuggestions(suggestions) {
            const container = document.getElementById('searchSuggestions');
            
            if (suggestions.length === 0) {
                container.innerHTML = '<div class="suggestion-item">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
                return;
            }
            
            let html = '';
            suggestions.forEach(coin => {
                html += `
                    <div class="suggestion-item" onclick="selectCoin('${coin.id}', '${coin.name}')">
                        <strong>${coin.name}</strong> (${coin.symbol})
                        <br><small>Rank: #${coin.market_cap_rank || 'N/A'}</small>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // ì½”ì¸ ì„ íƒ
        async function selectCoin(coinId, coinName) {
            document.getElementById('coinSearch').value = coinName;
            document.getElementById('searchSuggestions').innerHTML = '';
            
            // ë¶„ì„ ì‹¤í–‰
            await analyzeCoin(coinId);
        }

        // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­
        document.getElementById('searchBtn').addEventListener('click', async function() {
            const query = document.getElementById('coinSearch').value.trim();
            if (!query) return;
            
            // ì§ì ‘ ì…ë ¥í•œ ê²½ìš° ì²« ë²ˆì§¸ ê²€ìƒ‰ ê²°ê³¼ ì‚¬ìš©
            const suggestions = await searchCoin(query);
            if (suggestions.length > 0) {
                await analyzeCoin(suggestions[0].id);
            }
        });

        // ì½”ì¸ ë¶„ì„ ì‹¤í–‰
        async function analyzeCoin(coinId) {
            const resultsContainer = document.getElementById('searchResults');
            const cardContainer = document.getElementById('searchedCoinCard');
            
            // ë¡œë”© í‘œì‹œ
            resultsContainer.style.display = 'block';
            cardContainer.innerHTML = '<div style="text-align: center; padding: 40px;">ë¶„ì„ ì¤‘...</div>';
            
            try {
                // ì½”ì¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const coinData = await fetchSpecificCoin(coinId);
                
                if (!coinData) {
                    cardContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff4757;">ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                // ë™ì¼í•œ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¡œì§ ì ìš©
                const coinScore = calculateCoinScore(coinData);
                const strategy = getStrategyDirection(coinScore, coinData.change);
                const prices = calculateTradingPrices(coinData, strategy);
                
                let cardClass = 'neutral';
                if (strategy.direction === 'LONG') cardClass = 'bullish';
                else if (strategy.direction === 'SHORT') cardClass = 'bearish';
                
                // ê²€ìƒ‰ ê²°ê³¼ ì¹´ë“œ í‘œì‹œ
                cardContainer.innerHTML = `
                    <div class="price-card ${cardClass}">
                        <div class="coin-header">
                            <div class="coin-name">${coinData.icon} ${coinData.symbol}</div>
                            <div class="coin-score">${coinScore}/140</div>
                        </div>
                        <div class="coin-price">
                            $${formatPrice(coinData.price)}
                        </div>
                        <div class="price-change">
                            ${coinData.change >= 0 ? '+' : ''}${coinData.change.toFixed(2)}%
                        </div>
                        
                        <div class="strategy-direction ${strategy.class}">
                            ${strategy.signal}
                        </div>
                        
                        <div class="trading-info">
                            <div class="trading-grid">
                                <div class="trading-item">
                                    <span class="trading-label">${strategy.direction === 'SHORT' ? 'ìˆ ì§„ì…ê°€:' : 'ë¡± ì§„ì…ê°€:'}</span>
                                    <span class="trading-value entry-price">$${formatPrice(prices.entry)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ëª©í‘œê°€:</span>
                                    <span class="trading-value target-price">$${formatPrice(prices.target)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ì†ì ˆê°€:</span>
                                    <span class="trading-value stop-loss">$${formatPrice(prices.stop)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ì†ìµë¹„:</span>
                                    <span class="trading-value risk-reward">1:${prices.rr}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('ë¶„ì„ ì—ëŸ¬:', error);
                cardContainer.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff4757;">ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>';
            }
        }
        
        // API í˜¸ì¶œ (ì‹¤ì œ ì‹¤ì‹œê°„ ê°€ê²©)
        async function fetchCryptoData() {
            const timestamp = new Date().toLocaleTimeString();
            updateDebugInfo('ìš”ì²­ ì¤‘...', timestamp, '-');
            
            try {
                // ì™„ì „í•œ API URL
                const url = 'https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,ripple,solana,binancecoin,cardano&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true';
                
                console.log('API ìš”ì²­ URL:', url);
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'x-cg-pro-api-key': API_KEY
                    }
                });
                
                console.log('ì‘ë‹µ ìƒíƒœ:', response.status);
                updateDebugInfo(`ì‘ë‹µ ë°›ìŒ (${response.status})`, timestamp, '-');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('ì‹¤ì œ API ì‘ë‹µ:', data);
                
                updateDebugInfo('ì„±ê³µ', timestamp, JSON.stringify(data).substring(0, 100) + '...');
                
                // ì‹¤ì œ API ë°ì´í„°ë¥¼ ì‚¬ìš©
                if (data && Object.keys(data).length > 0) {
                    cryptoData = [
                        {
                            symbol: 'BTC',
                            name: 'Bitcoin',
                            icon: 'ğŸ”¥',
                            price: data.bitcoin?.usd || 0,
                            change: data.bitcoin?.usd_24h_change || 0,
                            volume: data.bitcoin?.usd_24h_vol || 0,
                            marketCap: data.bitcoin?.usd_market_cap || 0
                        },
                        {
                            symbol: 'ETH',
                            name: 'Ethereum',
                            icon: 'â­',
                            price: data.ethereum?.usd || 0,
                            change: data.ethereum?.usd_24h_change || 0,
                            volume: data.ethereum?.usd_24h_vol || 0,
                            marketCap: data.ethereum?.usd_market_cap || 0
                        },
                        {
                            symbol: 'XRP',
                            name: 'Ripple',
                            icon: 'ğŸ’',
                            price: data.ripple?.usd || 0,
                            change: data.ripple?.usd_24h_change || 0,
                            volume: data.ripple?.usd_24h_vol || 0,
                            marketCap: data.ripple?.usd_market_cap || 0
                        },
                        {
                            symbol: 'SOL',
                            name: 'Solana',
                            icon: 'â˜€ï¸',
                            price: data.solana?.usd || 0,
                            change: data.solana?.usd_24h_change || 0,
                            volume: data.solana?.usd_24h_vol || 0,
                            marketCap: data.solana?.usd_market_cap || 0
                        },
                        {
                            symbol: 'BNB',
                            name: 'Binance',
                            icon: 'ğŸª™',
                            price: data.binancecoin?.usd || 0,
                            change: data.binancecoin?.usd_24h_change || 0,
                            volume: data.binancecoin?.usd_24h_vol || 0,
                            marketCap: data.binancecoin?.usd_market_cap || 0
                        },
                        {
                            symbol: 'ADA',
                            name: 'Cardano',
                            icon: 'ğŸŒŸ',
                            price: data.cardano?.usd || 0,
                            change: data.cardano?.usd_24h_change || 0,
                            volume: data.cardano?.usd_24h_vol || 0,
                            marketCap: data.cardano?.usd_market_cap || 0
                        }
                    ].filter(coin => coin.price > 0); // ê°€ê²©ì´ 0ì¸ ì½”ì¸ ì œì™¸
                    
                    isApiWorking = true;
                    document.getElementById('apiStatus').textContent = 'API âœ… PRO';
                    document.getElementById('apiStatus').className = 'api-status';
                    
                    console.log('ì²˜ë¦¬ëœ ì‹¤ì‹œê°„ ë°ì´í„°:', cryptoData);
                    return cryptoData;
                } else {
                    throw new Error('API ë°ì´í„°ê°€ ë¹„ì–´ìˆìŒ');
                }
                
            } catch (error) {
                console.error('API ì—ëŸ¬:', error);
                updateDebugInfo(`ì—ëŸ¬: ${error.message}`, timestamp, '-');
                document.getElementById('apiStatus').textContent = 'API âŒ ë”ë¯¸';
                document.getElementById('apiStatus').className = 'api-status api-error';
                
                // API ì‹¤íŒ¨ì‹œ ë”ë¯¸ ë°ì´í„° ì‚¬ìš©
                return getDummyData();
            }
        }
        
        // ë”ë¯¸ ë°ì´í„° (API ì‹¤íŒ¨ì‹œ ë°±ì—…)
        function getDummyData() {
            console.log('ë”ë¯¸ ë°ì´í„° ì‚¬ìš© ì¤‘...');
            updateDebugInfo('ë”ë¯¸ ë°ì´í„° ì‚¬ìš©', new Date().toLocaleTimeString(), 'ë”ë¯¸ ë°ì´í„° ë¡œë“œë¨');
            return [
                { symbol: 'BTC', name: 'Bitcoin', icon: 'ğŸ”¥', price: 99850, change: 1.2, volume: 28000000000, marketCap: 1950000000000 },
                { symbol: 'ETH', name: 'Ethereum', icon: 'â­', price: 3580, change: -0.5, volume: 18000000000, marketCap: 430000000000 },
                { symbol: 'XRP', name: 'Ripple', icon: 'ğŸ’', price: 2.45, change: 2.8, volume: 3500000000, marketCap: 135000000000 },
                { symbol: 'SOL', name: 'Solana', icon: 'â˜€ï¸', price: 185, change: 3.5, volume: 3200000000, marketCap: 85000000000 },
                { symbol: 'BNB', name: 'Binance', icon: 'ğŸª™', price: 520, change: 0.8, volume: 1800000000, marketCap: 78000000000 },
                { symbol: 'ADA', name: 'Cardano', icon: 'ğŸŒŸ', price: 0.95, change: 1.5, volume: 1200000000, marketCap: 33000000000 }
            ];
        }
        
        // ê°œë³„ ì½”ì¸ ì ìˆ˜ ê³„ì‚° (6ë‹¨ê³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜)
        function calculateCoinScore(coin) {
            let score = 0;
            
            // ê±°ì‹œí™˜ê²½ (ê°€ê²© ëŒ€ë¹„)
            if (coin.symbol === 'BTC' && coin.price > 95000) score += 20;
            else if (coin.symbol === 'ETH' && coin.price > 3500) score += 18;
            else if (coin.price > 0) score += 15;
            
            // 24ì‹œê°„ ë³€í™”ìœ¨
            if (coin.change > 5) score += 25;
            else if (coin.change > 2) score += 20;
            else if (coin.change > 0) score += 15;
            else if (coin.change > -2) score += 10;
            else score += 5;
            
            // ê±°ë˜ëŸ‰ (ì‹œì¥ í™œì„±ë„)
            if (coin.volume > 20000000000) score += 25;
            else if (coin.volume > 10000000000) score += 20;
            else if (coin.volume > 5000000000) score += 15;
            else score += 10;
            
            // ì‹œê°€ì´ì•¡ (ì•ˆì •ì„±)
            if (coin.marketCap > 1000000000000) score += 20;
            else if (coin.marketCap > 100000000000) score += 15;
            else if (coin.marketCap > 50000000000) score += 12;
            else score += 8;
            
            // ê¸°ìˆ ì  ë¶„ì„ (ë³€í™”ìœ¨ ê¸°ë°˜)
            if (Math.abs(coin.change) < 1) score += 20; // ì•ˆì •ì 
            else if (Math.abs(coin.change) < 3) score += 15;
            else score += 10;
            
            // ì „ëµ ì ìˆ˜
            if (coin.change > 0 && coin.volume > 5000000000) score += 10;
            else if (coin.change > -1) score += 7;
            else score += 3;
            
            // ì¶”ê°€ ì ìˆ˜ (AI/ë¯¸ë˜ ê¸°ìˆ )
            if (coin.symbol === 'SOL' || coin.symbol === 'ETH') score += 5; // AI/DeFi ê´€ë ¨
            
            return Math.min(140, Math.max(0, score));
        }
        
        // ì „ëµ ë°©í–¥ ê²°ì • (ë¡±/ìˆ/í™€ë“œ)
        function getStrategyDirection(coinScore, change) {
            if (coinScore >= 100 && change > 0) {
                return { direction: 'LONG', class: 'long-strategy', signal: 'ğŸ“ˆ ê°•ë ¥ ë§¤ìˆ˜' };
            } else if (coinScore >= 80 && change > -1) {
                return { direction: 'LONG', class: 'long-strategy', signal: 'ğŸ“ˆ ë§¤ìˆ˜' };
            } else if (coinScore <= 40 && change < -2) {
                return { direction: 'SHORT', class: 'short-strategy', signal: 'ğŸ“‰ ë§¤ë„/ìˆ' };
            } else if (coinScore <= 60 && change < 0) {
                return { direction: 'SHORT', class: 'short-strategy', signal: 'ğŸ“‰ ì•½ì„¸' };
            } else {
                return { direction: 'HOLD', class: 'hold-strategy', signal: 'âš–ï¸ ê´€ë§' };
            }
        }
        
        // ì²´í¬ë¦¬ìŠ¤íŠ¸ ì ìˆ˜ ê³„ì‚°
        function calculateChecklistScores() {
            if (!cryptoData || cryptoData.length === 0) return 0;
            
            const avgChange = cryptoData.reduce((sum, coin) => sum + (coin.change || 0), 0) / cryptoData.length;
            const totalVolume = cryptoData.reduce((sum, coin) => sum + (coin.volume || 0), 0);
            const btc = cryptoData.find(coin => coin.symbol === 'BTC');
            
            // ì‹¤ì œ ì‹œì¥ ë°ì´í„° ê¸°ë°˜ ì ìˆ˜ ê³„ì‚°
            checklistItems[0].score = Math.min(20, Math.max(0, Math.floor(10 + avgChange * 2)));
            checklistItems[1].score = Math.min(25, Math.max(0, btc ? Math.floor(12 + (btc.price > 95000 ? 10 : 5)) : 12));
            checklistItems[2].score = Math.min(25, Math.max(0, Math.floor(totalVolume / 5000000000)));
            checklistItems[3].score = Math.min(20, Math.max(0, Math.floor(10 + avgChange)));
            checklistItems[4].score = Math.min(20, Math.max(0, Math.floor(15 - Math.abs(avgChange) * 2)));
            checklistItems[5].score = Math.min(20, Math.max(0, btc ? Math.floor(10 + btc.change * 3) : 10));
            checklistItems[6].score = Math.min(10, Math.max(0, Math.floor(5 + avgChange)));
            
            return checklistItems.reduce((sum, item) => sum + item.score, 0);
        }
        
        // íŠ¸ë ˆì´ë”© ê°€ê²© ê³„ì‚° (ë¡±/ìˆ êµ¬ë¶„)
        function calculateTradingPrices(coin, strategy) {
            const currentPrice = parseFloat(coin.price) || 0;
            if (currentPrice === 0) return { entry: 0, target: 0, stop: 0, rr: '0' };
            
            let entryPrice, targetPrice, stopLoss, riskReward;
            
            if (strategy.direction === 'LONG') {
                // ë¡± í¬ì§€ì…˜
                entryPrice = currentPrice * 1.002;  // 0.2% ìœ„ì—ì„œ ì§„ì…
                targetPrice = currentPrice * 1.08;  // 8% ìˆ˜ìµ ëª©í‘œ
                stopLoss = currentPrice * 0.95;     // 5% ì†ì ˆ
            } else if (strategy.direction === 'SHORT') {
                // ìˆ í¬ì§€ì…˜
                entryPrice = currentPrice * 0.998;  // 0.2% ì•„ë˜ì—ì„œ ì§„ì…
                targetPrice = currentPrice * 0.92;  // 8% í•˜ë½ ëª©í‘œ
                stopLoss = currentPrice * 1.05;     // 5% ì†ì ˆ
            } else {
                // í™€ë“œ/ê´€ë§
                entryPrice = currentPrice;
                targetPrice = currentPrice * 1.03;  // 3% ëª©í‘œ
                stopLoss = currentPrice * 0.97;     // 3% ì†ì ˆ
            }
            
            const risk = Math.abs(entryPrice - stopLoss);
            const reward = Math.abs(targetPrice - entryPrice);
            riskReward = risk > 0 ? (reward / risk).toFixed(2) : '0';
            
            return {
                entry: entryPrice,
                target: targetPrice,
                stop: stopLoss,
                rr: riskReward
            };
        }
        
        // ê°€ê²© í¬ë§·íŒ…
        function formatPrice(price) {
            if (!price || price === 0) return '0';
            if (price > 10000) return price.toFixed(0);
            if (price > 100) return price.toFixed(2);
            if (price > 1) return price.toFixed(3);
            return price.toFixed(4);
        }
        
        // ê°€ê²© ì¹´ë“œ ë Œë”ë§
        function renderPriceCards() {
            const container = document.getElementById('priceCards');
            
            if (!cryptoData || cryptoData.length === 0) {
                container.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px;">ë°ì´í„°ë¥¼ ë¡œë”©ì¤‘ì…ë‹ˆë‹¤...</div>';
                return;
            }
            
            let html = '';
            cryptoData.forEach(coin => {
                const coinScore = calculateCoinScore(coin);
                const strategy = getStrategyDirection(coinScore, coin.change);
                const prices = calculateTradingPrices(coin, strategy);
                
                let cardClass = 'neutral';
                if (strategy.direction === 'LONG') cardClass = 'bullish';
                else if (strategy.direction === 'SHORT') cardClass = 'bearish';
                
                html += `
                    <div class="price-card ${cardClass}">
                        <div class="coin-header">
                            <div class="coin-name">${coin.icon} ${coin.symbol}</div>
                            <div class="coin-score">${coinScore}/140</div>
                        </div>
                        <div class="coin-price">
                            $${formatPrice(coin.price)}
                        </div>
                        <div class="price-change">
                            ${coin.change >= 0 ? '+' : ''}${coin.change.toFixed(2)}%
                        </div>
                        
                        <div class="strategy-direction ${strategy.class}">
                            ${strategy.signal}
                        </div>
                        
                        <div class="trading-info">
                            <div class="trading-grid">
                                <div class="trading-item">
                                    <span class="trading-label">${strategy.direction === 'SHORT' ? 'ìˆ ì§„ì…ê°€:' : 'ë¡± ì§„ì…ê°€:'}</span>
                                    <span class="trading-value entry-price">$${formatPrice(prices.entry)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ëª©í‘œê°€:</span>
                                    <span class="trading-value target-price">$${formatPrice(prices.target)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ì†ì ˆê°€:</span>
                                    <span class="trading-value stop-loss">$${formatPrice(prices.stop)}</span>
                                </div>
                                <div class="trading-item">
                                    <span class="trading-label">ì†ìµë¹„:</span>
                                    <span class="trading-value risk-reward">1:${prices.rr}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        // ì²´í¬ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        function renderChecklist() {
            const container = document.getElementById('checklistGrid');
            let html = '';
            
            checklistItems.forEach(item => {
                const percentage = item.max > 0 ? (item.score / item.max) * 100 : 0;
                html += `
                    <div class="checklist-item">
                        <div class="checklist-item-header">
                            <span>${item.name}</span>
                            <span class="checklist-score">${item.score}/${item.max}ì </span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            
            const totalScore = checklistItems.reduce((sum, item) => sum + item.score, 0);
            document.getElementById('totalScore').textContent = `${totalScore}/140ì `;
            
            return totalScore;
        }
        
        // ì „ëµ ì—…ë°ì´íŠ¸
        function updateStrategy(totalScore) {
            let signal, leverage, position, status, avgRR;
            
            if (totalScore >= 120) {
                signal = 'ğŸš€ ê°•í•œ ë§¤ìˆ˜ ì‹ í˜¸';
                leverage = '5-7x';
                position = '90%';
                status = 'ê°•ì„¸ì¥';
                avgRR = '1:4';
            } else if (totalScore >= 100) {
                signal = 'ğŸ“ˆ ë§¤ìˆ˜ ìš°ìœ„';
                leverage = '3-5x';
                position = '70%';
                status = 'ìƒìŠ¹ì¥';
                avgRR = '1:2.5';
            } else if (totalScore >= 80) {
                signal = 'âš–ï¸ ì¤‘ë¦½ ì‹œì¥';
                leverage = '1-3x';
                position = '50%';
                status = 'íš¡ë³´ì¥';
                avgRR = '1:1.5';
            } else {
                signal = 'âš ï¸ ì£¼ì˜ í•„ìš”';
                leverage = 'ë¬´ë ˆë²„ë¦¬ì§€';
                position = '30%';
                status = 'ì•½ì„¸ì¥';
                avgRR = '1:1';
            }
            
            document.getElementById('strategySignal').textContent = signal;
            document.getElementById('leverageRec').textContent = leverage;
            document.getElementById('positionSize').textContent = position;
            document.getElementById('avgRiskReward').textContent = avgRR;
            document.getElementById('marketStatus').textContent = status;
        }
        
        // ë©”ì¸ ì—…ë°ì´íŠ¸
        async function updateDashboard() {
            console.log('ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸ ì‹œì‘...');
            
            await fetchCryptoData();
            
            if (cryptoData && cryptoData.length > 0) {
                renderPriceCards();
                const totalScore = renderChecklist();
                updateStrategy(totalScore);
            }
            
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString('ko-KR');
        }
        
        // ì¹´ìš´íŠ¸ë‹¤ìš´
        function startCountdown() {
            setInterval(() => {
                countdown--;
                if (countdown <= 0) {
                    countdown = 60;
                    updateDashboard();
                }
                document.getElementById('countdown').textContent = countdown;
            }, 1000);
        }
        
        // ì´ˆê¸°í™”
        async function init() {
            console.log('ì•± ì´ˆê¸°í™”...');
            await updateDashboard();
            startCountdown();
            
            // 2ë¶„ë§ˆë‹¤ ìë™ ì—…ë°ì´íŠ¸ (API ì œí•œ ê³ ë ¤)
            setInterval(updateDashboard, 120000);
        }
        
        // í˜ì´ì§€ ë¡œë“œì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
